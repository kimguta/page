
<!DOCTYPE html>
<html lang="ko">
<head>
	<title>오프셋 테스트</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">
	<link href="https://cdn.jsdelivr.net/npm/reset-css@5.0.2/reset.min.css" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-latest.min.js"></script>
</head>
<body>
	<div class="offset full-page" style="background:blue;height:600px" data-nav-text="1 페이지"></div>
	<div class="offset full-page" style="background:red;height:600px" data-nav-text="2 페이지"></div>
	<div class="offset full-page" style="background:green;height:600px" data-nav-text="3 페이지"></div>
	<div class="offset full-page" style="background:yellow;height:600px" data-nav-text="4 페이지"></div>
	<div class="offset full-page" style="background:gray;height:600px" data-nav-text="5 페이지"></div>
	<div class="offset full-page" style="background:purple;height:600px" data-nav-text="6 페이지"></div>
	<div class="offset full-page" style="background:blue;height:600px" data-nav-text="7 페이지"></div>

	<div class="page-nav" style="">

	</div>
</body>
</html>

<style>
	.page-nav{position:fixed;left:30px;top:50%;z-index:100;display:flex;flex-direction:column;transform:translateY(-50%);}
</style>

<script>
/*오프셋 액티브*/
function elemOffset(obj){
	$(obj).each(function(){
        var elemTop = $(this).offset().top;
        var elemBottom =$(this).offset().top + $(this).outerHeight();
		var winTop = $(document).scrollTop();
        var winBottom = $(document).scrollTop() + $(window).outerHeight()


		//요소 화면 인

		if( elemTop <= winBottom ){
			$(this).addClass('elem-in');
		}

		//요소 아래쪽 붙음
		if( elemBottom <= winBottom ){
			$(this).addClass('elem-bottom');
		}

		//요소 위쪽 붙음
		if( elemTop <= winTop ){
			$(this).addClass('elem-top');
		}

		//요소 화면 아웃
		if( elemBottom <=  winTop ){
			$(this).addClass('elem-out');
		}
	});
}

$(window).on('scroll', function(){
	elemOffset('.offset');
});

function FullPage(obj, nav) {
    var $pages = $(obj);  // 페이지 객체 캐싱
    var $nav = $(nav);    // 네비게이션 객체 캐싱
    var pageCount = $pages.length;  // 페이지 수 계산

    // 페이지 수만큼 버튼 추가 (각 페이지의 data-nav-text 값을 버튼에 적용)
    $pages.each(function(index) {
        var navText = $(this).data('nav-text') || '페이지 ' + (index + 1);  // 데이터가 없을 경우 기본값 설정
        $nav.append('<button class="page-btn" data-index="' + index + '">' + navText + '</button>');
    });

    // 스크롤 애니메이션 함수 (중복 제거)
    function scrollToPage(index) {
        var targetOffset = $pages.eq(index).offset().top;
        $('html, body').stop().animate({ scrollTop: targetOffset }, 500);
    }

    // 휠 이벤트 처리
    $pages.on('wheel', function(e) {
        var currentIndex = $pages.index(this);
        var direction = e.originalEvent.deltaY > 0 ? 1 : -1;  // 휠 방향에 따른 계산
        var newIndex = currentIndex + direction;

        if (newIndex >= 0 && newIndex < pageCount) {  // 페이지 범위 내에서만 이동
            scrollToPage(newIndex);
        }
    });

    // 버튼 클릭 시 해당 페이지로 이동
    $nav.on('click', '.page-btn', function() {
        var index = $(this).data('index');
        scrollToPage(index);
    });
}

$(function() { 
    FullPage('.full-page', '.page-nav');
});


</script>
